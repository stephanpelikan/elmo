<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
		xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.0.xsd"
		logicalFilePath="./00.00.01.xml">
  <changeSet id="http-session-store" author="stephanpelikan">
    <comment>Create table necessary to use EnableJdbcHttpSession</comment>
    <sqlFile dbms="h2" path="classpath:org/springframework/session/jdbc/schema-h2.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="postgresql" path="classpath:org/springframework/session/jdbc/schema-postgresql.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="db2" path="classpath:org/springframework/session/jdbc/schema-db2.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="derby" path="classpath:org/springframework/session/jdbc/schema-derby.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="hsqldb" path="classpath:org/springframework/session/jdbc/schema-hsqldb.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="mysql" path="classpath:org/springframework/session/jdbc/schema-mysql.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="oracle" path="classpath:org/springframework/session/jdbc/schema-oracle.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="sqlite" path="classpath:org/springframework/session/jdbc/schema-sqlite.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="sqlserver" path="classpath:org/springframework/session/jdbc/schema-sqlserver.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="sybase" path="classpath:org/springframework/session/jdbc/schema-sybase.sql" relativeToChangelogFile="false" />
  </changeSet>
  <changeSet id="oauth2-token-store" author="stephanpelikan">
    <comment>Create table necessary to use JdbcOAuth2AuthorizedClientService</comment>
    <sqlFile dbms="!postgresql" path="classpath:org/springframework/security/oauth2/client/oauth2-client-schema.sql" relativeToChangelogFile="false" />
    <sqlFile dbms="postgresql" path="classpath:org/springframework/security/oauth2/client/oauth2-client-schema-postgres.sql" relativeToChangelogFile="false" />
  </changeSet>
	<changeSet id="initial-setup-of-members"
		author="stephanpelikan">
		<comment>Create table for Member</comment>
		<createTable tableName="ELMO_OAUTH_ID">
			<column name="ID" type="varchar(255)">
				<constraints primaryKey="true" />
			</column>
			<column name="OWNER" type="varchar(40)">
				<constraints nullable="false" />
			</column>
			<column name="PROVIDER" type="varchar(40)">
				<constraints nullable="false" />
			</column>
		</createTable>
		<createTable tableName="ELMO_MEMBER">
			<column name="ID" type="varchar(40)">
				<constraints primaryKey="true" />
			</column>
      <column name="TYPE" type="varchar(1)" />
			<column name="STATUS" type="varchar(30)" />
      <column name="APPLICATION_USERTASK" type="varchar(40)" />
      <column name="APPLICATION_COMMENT" type="clob" />
      <column name="APPLICATION_ROLE" type="varchar(20)" />
			<column name="CREATED_AT" type="timestamp">
				<constraints nullable="false" />
			</column>
			<column name="UPDATED_AT" type="timestamp" />
			<column name="MEMBER_ID" type="int" />
			<column name="EMAIL" type="varchar(2048)" />
      <column name="GIVEN_EMAIL_CODE" type="varchar(4)" />
      <column name="GENERATED_EMAIL_CODE" type="varchar(4)" />
			<column name="FIRST_NAME" type="varchar(255)" />
			<column name="LAST_NAME" type="varchar(255)" />
			<column name="BIRTHDATE" type="date" />
			<column name="SEX" type="varchar(6)" />
			<column name="ZIP" type="varchar(10)" />
			<column name="CITY" type="varchar(255)" />
			<column name="STREET" type="varchar(255)" />
			<column name="STREET_NUMBER" type="varchar(25)" />
			<column name="PHONE_NUMBER" type="varchar(30)" />
      <column name="GIVEN_PHONE_CODE" type="varchar(4)" />
      <column name="GENERATED_PHONE_CODE" type="varchar(4)" />
			<column name="NOTIFY_PER_SMS" type="boolean" />
			<column name="COMMENT" type="clob" />
		</createTable>
    <createTable tableName="ELMO_MEMBER_ROLE">
      <column name="MEMBER" type="varchar(40)">
        <constraints primaryKey="true" />
      </column>
      <column name="ROLE" type="varchar(20)">
        <constraints primaryKey="true" />
      </column>
    </createTable>
	</changeSet>
  <changeSet id="introduce-sms-service"
    author="stephanpelikan">
    <comment>Create table for SMS to be sent</comment>
    <createTable tableName="ELMO_SMS">
      <column name="ID" type="varchar(40)">
        <constraints primaryKey="true" />
      </column>
      <column name="STATUS" type="varchar(30)">
        <constraints nullable="false" />
      </column>
      <column name="CREATED_AT" type="timestamp">
        <constraints nullable="false" />
      </column>
      <column name="UPDATED_AT" type="timestamp" />
    </createTable>
  </changeSet>
  <changeSet id="introduce-config-value"
    author="stephanpelikan">
    <comment>Create table for config values</comment>
    <createTable tableName="ELMO_CONFIG">
      <column name="NAME" type="varchar(100)">
        <constraints primaryKey="true" />
      </column>
      <column name="VALUE" type="varchar(255)">
        <constraints nullable="false" />
      </column>
    </createTable>
  </changeSet>
</databaseChangeLog>
